<!DOCTYPE html>
<html>
<head>
    <title>Upload Video File</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
	<link rel="stylesheet" href="/stylesheets/bootstrap.min.css">
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script src="/javascripts/bootstrap.min.js"></script>
</head>
<body>
	<div class="container">
		<h1>Upload</h1>
		<p class="text text-muted">Ocp-Apim-Subscription-Key: <%=subKey%></p>
		<p class="text text-muted">API URL: <%=apiURL%></p>
		<div class="well">
			<h2>Upload Video File</h2>
			<form id="FormFile" class="form form-horizontal" method="post" enctype="multipart/form-data">
				<input type="file" class="form-control" value="Choose a file" accept="video/*">
				<br>
				<input type="submit" class="btn btn-success" value="Submit">
			</form>
		</div>

		<div class="well">
			<h2>Upload via URL</h2>
			<form id="FormURL" class="form form-horizontal" method="post">
				<input type="url" class="form-control" name="url" id="url" value="http://techslides.com/demos/sample-videos/small.mp4" required>
				<br>
				<input type="submit" class="btn btn-success" value="Submit">
			</form>
		</div>
		
		<div class="well" id="info">
		</div>
	</div>
	
<script type="text/javascript">
	$().ready(function() {
		$('#data').html( $('#FormURL #url').val() );
	});
	
	$(document).ready(function(){		
		$( "#FormFile" ).submit(function( event ) {
			alert( "Still in construction" );
			event.preventDefault();
		});
		
		$( "#FormURL" ).submit(function( event ) {
			var params = {
				// Request parameters
			};
			$.ajax({
				url: "<%=apiURL%>?" + $.param(params),
				beforeSend: function(xhrObj){
					// Request headers
					xhrObj.setRequestHeader("Content-Type","application/json");
					xhrObj.setRequestHeader("Ocp-Apim-Subscription-Key","<%=subKey%>");
				},
				type: 'POST',
				data: '{ "url" : "'+ $('#FormURL #url').val() +'"}',
				success: function(data, status, request) {
					$('#info').append('Đang gửi dữ liệu...').delay(5000);
					window.location.replace("/video-api/wait-for-result?operationLocation=" +request.getResponseHeader('Operation-Location'));
				},
				fail: function() {
					alert("Lỗi! Coi lại dữ liệu");
				}
			});
			event.preventDefault();
		});
	});
</script>
</body>
</html>